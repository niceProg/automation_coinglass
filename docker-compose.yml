services:
  # =============================================================================
  # SYSTEM ADMINISTRATION
  # =============================================================================
  setup:
    build: .
    container_name: coinglass_setup
    env_file:
      - .env
    command: ["python", "main.py", "--setup"]
    restart: "no"
    profiles:
      - setup
    networks:
      - coinglass_network

  status:
    build: .
    container_name: coinglass_status
    env_file:
      - .env
    command: ["python", "main.py", "--status"]
    restart: "no"
    profiles:
      - monitoring
    networks:
      - coinglass_network

  freshness:
    build: .
    container_name: coinglass_freshness
    env_file:
      - .env
    command: ["python", "main.py", "--freshness"]
    restart: "no"
    profiles:
      - monitoring
    networks:
      - coinglass_network

  # =============================================================================
  # COINGLASS ENDPOINTS - 1 SERVICE PER TABLE
  # =============================================================================

  # Bitcoin ETF Flows Details
  cg_bitcoin_etf_flows_details:
    build: .
    container_name: coinglass_bitcoin_etf_flows_details
    env_file:
      - .env
    environment:
      - DELAY=60
      - PIPELINE=bitcoin_etf_flows_details
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - etf
      - production

  # Bitcoin ETF Flows History
  cg_bitcoin_etf_flows_history:
    build: .
    container_name: coinglass_bitcoin_etf_flows_history
    env_file:
      - .env
    environment:
      - DELAY=60
      - PIPELINE=bitcoin_etf_flows_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - etf
      - production

  # Bitcoin ETF List
  cg_bitcoin_etf_list:
    build: .
    container_name: coinglass_bitcoin_etf_list
    env_file:
      - .env
    environment:
      - DELAY=30
      - PIPELINE=bitcoin_etf_list
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - etf
      - production

  # Bitcoin ETF Premium Discount History
  cg_bitcoin_etf_premium_discount_history:
    build: .
    container_name: coinglass_bitcoin_etf_premium_discount_history
    env_file:
      - .env
    environment:
      - DELAY=30
      - PIPELINE=bitcoin_etf_premium_discount_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - etf
      - production

  # Fear Greed Index
  cg_fear_greed_index:
    build: .
    container_name: coinglass_fear_greed_index
    env_file:
      - .env
    environment:
      - DELAY=3600
      - PIPELINE=fear_greed_index
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - etf
      - production

  # Fear Greed Index Data List
  cg_fear_greed_index_data_list:
    build: .
    container_name: coinglass_fear_greed_index_data_list
    env_file:
      - .env
    environment:
      - DELAY=3600
      - PIPELINE=fear_greed_index_data_list
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - etf
      - production

  # Funding Rate Exchange List
  cg_funding_rate_exchange_list:
    build: .
    container_name: coinglass_funding_rate_exchange_list
    env_file:
      - .env
    environment:
      - DELAY=30
      - PIPELINE=funding_rate_exchange_list
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Funding Rate History
  cg_funding_rate_history:
    build: .
    container_name: coinglass_funding_rate_history
    env_file:
      - .env
    environment:
      - DELAY=30
      - PIPELINE=funding_rate_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Futures Basis History
  cg_futures_basis_history:
    build: .
    container_name: coinglass_futures_basis_history
    env_file:
      - .env
    environment:
      - DELAY=45
      - PIPELINE=futures_basis_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Futures Footprint History
  cg_future_footprint_history:
    build: .
    container_name: coinglass_future_footprint_history
    env_file:
      - .env
    environment:
      - DELAY=60
      - PIPELINE=futures_footprint_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Hyperliquid Whale Alert
  cg_hyperliquid_whale_alert:
    build: .
    container_name: coinglass_hyperliquid_whale_alert
    env_file:
      - .env
    environment:
      - DELAY=30
      - PIPELINE=hyperliquid_whale_alert
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Liquidation Aggregated History
  cg_liquidation_aggregated_history:
    build: .
    container_name: coinglass_liquidation_aggregated_history
    env_file:
      - .env
    environment:
      - DELAY=30
      - PIPELINE=liquidation_aggregated_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Liquidation Heatmap
  cg_liquidation_heatmap:
    build: .
    container_name: coinglass_liquidation_heatmap
    env_file:
      - .env
    environment:
      - DELAY=60
      - PIPELINE=liquidation_heatmap
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Liquidation Heatmap Leverage Data
  cg_liquidation_heatmap_leverage_data:
    build: .
    container_name: coinglass_liquidation_heatmap_leverage_data
    env_file:
      - .env
    environment:
      - DELAY=60
      - PIPELINE=liquidation_heatmap_leverage_data
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Liquidation Heatmap Price Candlesticks
  cg_liquidation_heatmap_price_candlesticks:
    build: .
    container_name: coinglass_liquidation_heatmap_price_candlesticks
    env_file:
      - .env
    environment:
      - DELAY=60
      - PIPELINE=liquidation_heatmap_price_candlesticks
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Liquidation Heatmap Y Axis
  cg_liquidation_heatmap_y_axis:
    build: .
    container_name: coinglass_liquidation_heatmap_y_axis
    env_file:
      - .env
    environment:
      - DELAY=60
      - PIPELINE=liquidation_heatmap_y_axis
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Long Short Global Account Ratio History
  cg_long_short_global_account_ratio_history:
    build: .
    container_name: coinglass_long_short_global_account_ratio_history
    env_file:
      - .env
    environment:
      - DELAY=30
      - PIPELINE=long_short_global_account_ratio_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Long Short Top Account Ratio History
  cg_long_short_top_account_ratio_history:
    build: .
    container_name: coinglass_long_short_top_account_ratio_history
    env_file:
      - .env
    environment:
      - DELAY=30
      - PIPELINE=long_short_top_account_ratio_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Open Interest Aggregated History
  cg_open_interest_aggregated_history:
    build: .
    container_name: coinglass_open_interest_aggregated_history
    env_file:
      - .env
    environment:
      - DELAY=20
      - PIPELINE=open_interest_aggregated_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Open Interest Aggregated Stablecoin History
  cg_open_interest_aggregated_stablecoin_history:
    build: .
    container_name: coinglass_open_interest_aggregated_stablecoin_history
    env_file:
      - .env
    environment:
      - DELAY=35
      - PIPELINE=open_interest_aggregated_stablecoin_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Option Exchange OI History
  cg_option_exchange_oi_history:
    build: .
    container_name: coinglass_option_exchange_oi_history
    env_file:
      - .env
    environment:
      - DELAY=30
      - PIPELINE=option_exchange_oi_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Option Exchange OI History Exchange Data
  cg_option_exchange_oi_history_exchange_data:
    build: .
    container_name: coinglass_option_exchange_oi_history_exchange_data
    env_file:
      - .env
    environment:
      - DELAY=30
      - PIPELINE=option_exchange_oi_history_exchange_data
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Option Exchange OI History Time List
  cg_option_exchange_oi_history_time_list:
    build: .
    container_name: coinglass_option_exchange_oi_history_time_list
    env_file:
      - .env
    environment:
      - DELAY=30
      - PIPELINE=option_exchange_oi_history_time_list
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # Spot Aggregated Taker Volume History
  cg_spot_aggregated_taker_volume_history:
    build: .
    container_name: coinglass_spot_aggregated_taker_volume_history
    env_file:
      - .env
    environment:
      - DELAY=60
      - PIPELINE=spot_aggregated_taker_volume_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - spot
      - production

  # Spot Coins Markets
  cg_spot_coins_markets:
    build: .
    container_name: coinglass_spot_coins_markets
    env_file:
      - .env
    environment:
      - DELAY=60
      - PIPELINE=spot_coins_markets
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - spot
      - production

  # Spot Large Orderbook
  cg_spot_large_orderbook:
    build: .
    container_name: coinglass_spot_large_orderbook
    env_file:
      - .env
    environment:
      - DELAY=25
      - PIPELINE=spot_large_orderbook
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - spot
      - production

  # Spot Large Orderbook History
  cg_spot_large_orderbook_history:
    build: .
    container_name: coinglass_spot_large_orderbook_history
    env_file:
      - .env
    environment:
      - DELAY=30
      - PIPELINE=spot_large_orderbook_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - spot
      - production

  # Spot Orderbook Aggregated
  cg_spot_orderbook_aggregated:
    build: .
    container_name: coinglass_spot_orderbook_aggregated
    env_file:
      - .env
    environment:
      - DELAY=25
      - PIPELINE=spot_orderbook_aggregated
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - spot
      - production

  # Spot Orderbook History
  cg_spot_orderbook_history:
    build: .
    container_name: coinglass_spot_orderbook_history
    env_file:
      - .env
    environment:
      - DELAY=60
      - PIPELINE=spot_orderbook_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - spot
      - production

  # Spot Pairs Markets
  cg_spot_pairs_markets:
    build: .
    container_name: coinglass_spot_pairs_markets
    env_file:
      - .env
    environment:
      - DELAY=60
      - PIPELINE=spot_pairs_markets
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - spot
      - production

  # Spot Price History
  cg_spot_price_history:
    build: .
    container_name: coinglass_spot_price_history
    env_file:
      - .env
    environment:
      - DELAY=60
      - PIPELINE=spot_price_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - spot
      - production

  # Spot Taker Volume History
  cg_spot_taker_volume_history:
    build: .
    container_name: coinglass_spot_taker_volume_history
    env_file:
      - .env
    environment:
      - DELAY=60
      - PIPELINE=spot_taker_volume_history
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - spot
      - production

  # Whale Transfer
  cg_whale_transfer:
    build: .
    container_name: coinglass_whale_transfer
    env_file:
      - .env
    environment:
      - DELAY=30
      - PIPELINE=whale_transfer
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
    profiles:
      - derivatives
      - production

  # =============================================================================
  # CRYPTOQUANT ENDPOINTS - 1 SERVICE PER TABLE
  # =============================================================================

  # CryptoQuant Exchange Inflow CDD
  cq_exchange_inflow_cdd:
    build: .
    container_name: cryptoquant_exchange_inflow_cdd
    env_file:
      - .env
    environment:
      - DELAY=900
      - PIPELINE=exchange_inflow_cdd
    entrypoint: ["/bin/bash", "/app/entrypoint.sh"]
    restart: unless-stopped
    networks:
      - coinglass_network
    dns:
      - 8.8.8.8
      - 8.8.4.4
      - 1.1.1.1
    profiles:
      - cryptoquant
      - production

networks:
  coinglass_network:
    driver: bridge
    name: coinglass_automation_network
    driver_opts:
      com.docker.network.bridge.name: coinglass-br0
